/*! violette 02-02-2015 */
var Utils=function(a,b){"use strict";function c(a,b){return a+d(b-a)}function d(a){return Math.floor(Math.random()*a)}function e(a){return a+"-"+c(1,1e4)}function f(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}return b.createLocation=function(a,b,c){if(!(0>b||b>c)){if(!a)return{from:{line:-1,col:-1,offset:b},to:{line:-1,col:-1,offset:c}};var d=a.length;c=Math.min(c,d),b=Math.min(b,c);for(var e,f=0,g=0,h=0,i=0;d>=i;i++){if(i==b&&(e={line:f,col:i-g,offset:i}),i==c){var j={line:f,col:i-g,offset:i};return{from:e,to:j}}var k=a.charAt(i);"\n"==k?(g=i+1,"\r"!==h&&f++):"\r"==k&&(f++,g=i+1),h=k}}return{from:{line:-1,col:-1,offset:b},to:{line:-1,col:-1,offset:c}}},b.selectionOffsets=function(a,c,d){for(var e,f=a.getCursor("from"),g=c.split("\n"),h=f.line,i=0,j=0;j<g.length;j++){if(h==j){var k=i+f.line+f.ch,l=k+d.length;e=b.createLocation(c,k,l),console.log(k+" - "+l);break}i+=g[j].length}var m=0,n=0;return e&&(m=e.from.offset,n=e.to.offset),{start:m,end:n}},b.createCode=function(a,b,c,d,e,f,g,h,i,j){d=d||[],e=e||[],f=f||[],g=g||[],h=h||0,i=i||[],j=j||"";var k=document.location.href,l=Date.now();return b=b||"Java: *scratched* code snippet",{name:a,description:b,content:c,elapsedtime:j,tags:d,datastructures:e,algorithms:f,refactorings:g,confidence:h,comments:i,url:k,birthday:l}},b.brand=e,b.debounce=f,b}(window.jQuery,Utils||{}),Matcher=function(a,b){"use strict";function c(a,b){var c=[];return a.replace(b,function(){if(arguments&&arguments.length>0)for(var b=0;b<arguments.length;b++){var d=arguments[b];a===d&&c.push(d)}}),c.length>0}function d(a){var b=/(\/\*[\w'\s\r\n\*]*\*\/)|(\/\/[\w\s']*)/gm;return c(a,b)}function e(a){var b=/^\s*?(((public|private|protected|static|final|native|synchronized|abstract|threadsafe|transient)\s+?)*)\s*?(\w+?)\s+?(\w+?)\s*?\(([^)]*)\)[\w\s,]*?(?={)?\s*?/;return c(a,b)}function f(a,b){var c=/class[^;=\n]*\s[\S\s]*?(?={)/g,d=[];a.replace(c,function(){var a=arguments[0];a&&a.length>0&&d.push(a.replace("\n"," ").split(" ")[1])});var e=d[0];return e?e:b}return b.matches=c,b.isComment=d,b.isMethod=e,b.matchClassName=f,b}(window.jQuery,Matcher||{}),Html=function(a,b){"use strict";function c(a,c,d){var f=b.buildHtml("div",{"class":"info"},{});return c=e(a,c,f,d)}function d(a,c,d){var f=b.buildHtml("span",{"class":"tabnav-right"},{});return c=e(a,c,f,d)}function e(a,c,d,e){for(var f=e.length,g=0;f>g;g++){var h=(b.buildHtml("div",{"class":"btn-group"},{}),e[g]),i=h.name,j=h.title,k=h.icon,l=h.callback,m='<span class="'+k+'"></span>',n=a.namespace+"-"+i,o=b.buildHtml("button",m,{type:"button",title:j,"data-provider":a.namespace,"data-handler":n});o.tooltipster({position:"right",theme:"tooltip-custom-theme"}),a.handler.push(n),a.callback.push(l),d.append(o)}return c.append(d),c}function f(a,c){var d=b.buildHtml("span",{"class":"tabnav-right"},{}),e=b.buildHtml("div",{"class":"info"},{});a.status=b.buildHtml("span","NOT SAVED ",{"class":"status"});var f=b.buildHtml("span",{"class":"meta-divider"},{});e.append(a.status),e.append(f),c.append(e);for(var g=a.options.actions,h=g.length,i=0;h>i;i++){var j=(b.buildHtml("div",{"class":"btn-group"},{}),g[i]),k=j.name,l=j.title,m=j.icon,n=j.callback,o='<span class="'+m+'"></span>',p=a.namespace+"-"+k,q=b.buildHtml("button",o,{type:"button","class":"violette-button btn-dark-link",title:l,"data-provider":a.namespace,"data-handler":p});q.tooltipster({position:"right",theme:"tooltip-custom-theme"}),a.handler.push(p),a.callback.push(n),"plus"===k?e.append(q):d.append(q)}return c.append(d),c.append(e),c}function g(c,d,e){if(!d.is("textarea")){var f=null!=c.content?c.content:d.text(),g=a.trim(f);d.is("div")&&(g=g.replace(/(<([^>]+)>)/gi,"").replace(/ +(?= )/g,"").replace(/^ +/gm,"")),e=b.buildHtml("textarea",g,{"class":"file-editor-textarea violette-input"})}return c.textarea=e,e}return b.buildHtml=function(b,c,d){"string"!=typeof c&&(d=c,c=null);var e="<"+b;for(var f in d)if(d.hasOwnProperty(f)){if(d[f]===!1)continue;e+=" "+f+'="'+d[f]+'"'}return e+=c?">"+c+"</"+b+">":"/>",a(e)},b.buildHeader=function(a){var c=b.buildHtml("div",{"class":"violette-header  btn-toolbar"},{});return c=f(a,c)},b.buildFooter=function(a){var e=b.buildHtml("div",{"class":"violette-footer  btn-toolbar"},{});return e=c(a,e,a.options.modes),e=d(a,e,a.options.social)},b.buildBody=function(a,c){var d=b.buildHtml("div",{id:Utils.brand("editing"),"class":"editing"},{});return d.append(g(a,a.element,c)),d},b}(window.jQuery,Html||{}),Stopwatch=function(){"use strict";function a(a,b){this.startTime=0,this.stopTime=0,this.totalElapsed=0,this.started=!1,this.listener=void 0!=a?a:null,this.tickResolution=void 0!=b?b:500,this.tickInterval=null,this.onehour=36e5,this.onemin=6e4,this.onesec=1e3,this.start()}return a.prototype.start=function(){var a=function(a,b){return function(){return b.call(a)}};this.started||(this.startTime=(new Date).getTime(),this.stopTime=0,this.started=!0,this.tickInterval=setInterval(a(this,this.onTick),this.tickResolution))},a.prototype.stop=function(){return this.started&&(this.stopTime=(new Date).getTime(),this.started=!1,this.totalElapsed+=this.stopTime-this.startTime,null!=this.tickInterval&&clearInterval(this.tickInterval)),this.getElapsed()},a.prototype.reset=function(){this.totalElapsed=0,this.startTime=(new Date).getTime(),this.stopTime=this.startTime},a.prototype.restart=function(){this.stop(),this.reset(),this.start()},a.prototype.getElapsed=function(){var a=0;this.started&&(a=(new Date).getTime()-this.startTime),a+=this.totalElapsed;var b=parseInt(a/this.onehour);a%=this.onehour;var c=parseInt(a/this.onemin);a%=this.onemin;var d=parseInt(a/this.onesec),e=a%this.onesec;return{hours:b,minutes:c,seconds:d,milliseconds:e}},a.prototype.toString=function(){var a=function(a,b){for(a=a.toString();a.length<b;)a="0"+a;return a},b=this.getElapsed();return a(b.hours,2)+":"+a(b.minutes,2)+":"+a(b.seconds,2)},a.prototype.setListener=function(a){this.listener=a},a.prototype.onTick=function(){null!=this.listener&&this.listener(this)},a}(),Calls=function(a,b){"use strict";function c(b,c,d,e,f,g){a.ajax({type:b,headers:e,url:c,async:!0,data:JSON.stringify(d),dataType:f,success:function(a){var b={draft:a.draft,info:a.info,stages:a.stages,stage:a.stage,warnings:a.warnings,failure:a.failure};g&&g(b)},error:function(a,b,c){var d={failure:{message:a.responseText||c}};g&&g(d)}})}function d(a,b,d){var e={"Content-Type":"text/plain; charset=UTF-8","x-auth-token":"legolas"};c("GET",a,null,b||e,"text",d)}function e(a,b,d,e){var f={"Content-Type":"application/json; charset=UTF-8","x-auth-token":"legolas"};c("POST",a,b,d||f,"json",e)}function f(a,b,d,e){var f={"Content-Type":"application/json; charset=UTF-8","x-auth-token":"legolas"};c("PUT",a,b,d||f,"json",e)}return b.ACTIVE=!0,b.STAGING="http://www.cookandstuff.com/kiwi/",b.PRODUCTION="http://www.vesperin.com/kiwi/",b.CURRENT_HOST=b.ACTIVE?b.PRODUCTION:b.STAGING,b.CURATORS="&q=roles:curators",b.SERVICE_POST_URL=b.CURRENT_HOST+"eval?auth_token=legolas",b.SERVICE_GET_URL=b.CURRENT_HOST+"find?"+b.CURATORS,b.fetch=c,b.get=d,b.post=e,b.put=f,b}(window.jQuery,Calls||{}),Refactoring=function(a){"use strict";var b=Calls.SERVICE_POST_URL,c=Calls.SERVICE_GET_URL;return a.deleteSelection=function(a,c,d,e){var f=d.start,g=d.end,h=Utils.createCode(a,"Java: *scratched* code snippet",c),i={remove:{what:"region",where:[f,g],source:h}};Calls.post(b,i,null,e)},a.detectMissingImports=function(a,c,d){var e=Utils.createCode(a,"Java: *scratched* code snippet",c),f={inspect:{source:e,imports:!0}};Calls.post(b,f,null,d)},a.inspectWholeSourcecode=function(a,c,d){var e=Utils.createCode(a,"Java: *scratched* code snippet",c),f={inspect:{source:e,imports:!1}};Calls.post(b,f,null,d)},a.renameSelectedMember=function(a,c,d,e,f){var g=e.start,h=e.end,i=Utils.createCode(a,"Java: *scratched* code snippet",d),j={rename:{what:"member",to:c,where:[g,h],source:i}};Calls.post(b,j,null,f)},a.clipSelectedBlock=function(a,c,d,e){var f=d.start,g=d.end,h=Utils.createCode(a,"Java: *scratched* code snippet",c),i={slice:{source:h,where:[f,g]}};Calls.post(b,i,null,e)},a.deduplicate=function(a,c,d){var e=Utils.createCode(a,"Java: *scratched* code snippet",c),f={deduplicate:{source:e}};Calls.post(b,f,null,d)},a.fullCleanup=function(a,c,d){var e=Utils.createCode(a,"Java: *scratched* code snippet",c),f={cleanup:{source:e}};Calls.post(b,f,null,d)},a.optimize=function(a,c,d){var e=Utils.createCode(a,"Java: *scratched* code snippet",c),f={optimize:{source:e}};Calls.post(b,f,null,d)},a.format=function(a,c,d){var e=Utils.createCode(a,"Java: *scratched* code snippet",c),f={format:{source:e}};Calls.post(b,f,null,d)},a.getParticipants=function(a){Calls.get(c,null,a)},a.saveCodeSnippet=function(a,c){var d={persist:{source:a}};Calls.put(b,d,null,c)},a}(Refactoring||{}),Heuristics=function(a,b,c){"use strict";function d(a){return B.indexOf(a)>-1}function e(b){var c=(b.className+" "+(b.parentNode?b.parentNode.className:"")).split(/\s+/);return c=c.map(function(a){return a.replace(/^lang(uage)?-/,"")}),c.filter(function(b){return a.getLanguage(b)||"no-highlight"==b})[0]}function f(a){return["objective-c","cpp"].indexOf(a)>-1}function g(a){return["perl","prolog"].indexOf(a)>-1}function h(a){return["ecl","prolog"].indexOf(a)>-1}function i(a){return["typescript","xml"].indexOf(a)>-1}function j(a){return["common lisp","opencl"].indexOf(a)>-1}function k(a){return["rebol","r"].indexOf(a)>-1}function l(a){return["cs","java"].indexOf(a)>-1}function m(a){return["cpp","java"].indexOf(a)>-1}function n(a){return["c","java"].indexOf(a)>-1}function o(a){return["javascript","java"].indexOf(a)>-1}function p(a){return["cpp","cs"].indexOf(a)>-1}function q(a){var b=[];return a.indexOf("@interface")>-1&&b.push("objective-c"),(a.indexOf("#include <cstdint>")>-1||/include\\s*[<"]/.test(a)||/\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*</.test(a)||a.indexOf("::"))&&b.push("cpp"),b}function r(a){var b=[];return a.indexOf("use strict")>-1&&b.push("perl"),a.indexOf(":-")>-1&&b.push("prolog"),b}function s(a){var b=[];return a.indexOf(":=")>-1&&b.push("ecl"),a.indexOf(":-")>-1&&b.push("prolog"),b}function t(a){var b=[];return b.push(a.indexOf("</translation>")>-1?"xml":"typescript"),b}function u(a){var b=[];return a.indexOf("(defun ")>-1&&b.push("common lisp"),/\/\* |\/\/ |^\}/.test(a)&&b.push("opencl"),b}function v(a){var b=[];return/\bRebol\b/i.test(a)&&b.push("rebol"),a.indexOf("<-")>-1&&b.push("r"),b}function w(a){var b=[];return(a.indexOf("<summary>")>-1||a.indexOf("using System;")>-1||a.indexOf("typeof")>-1||a.indexOf("sizeof")>-1)&&b.push("cs"),a.indexOf("import")>-1&&b.push("java"),b}function x(a){var b=[];return(a.indexOf("#include <cstdint>")>-1||/#include\\s*[<"]/.test(a)||/\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*</.test(a)||a.indexOf("::"))&&b.push("cpp"),a.indexOf("import")>-1&&b.push("java"),b}function y(a){var b=[];return(a.indexOf("#include")>-1||/#include\\s*["]/.test(a))&&b.push("c"),a.indexOf("import")>-1&&b.push("java"),b}function z(a){var b=[];return(a.indexOf("!==")>-1||/\$[(.]/.test(a))&&b.push("javascript"),a.indexOf("import")>-1&&b.push("java"),b}function A(a){var b=[];return(a.indexOf("#include <cstdint>")>-1||/#include\\s*[<"]/.test(a)||/\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*</.test(a)||a.indexOf("::"))&&b.push("cpp"),(a.indexOf("<summary>")>-1||a.indexOf("using System;")>-1||a.indexOf("typeof")>-1||a.indexOf("sizeof")>-1)&&b.push("cs"),b}var B=["java"];return c.findByHeuristics=function(a,b){return b.every(f)?q(a):b.every(g)?r(a):b.every(h)?s(a):b.every(i)?t(a):b.every(j)?u(a):b.every(k)?v(a):b.every(l)?w(a):b.every(m)?x(a):b.every(n)?y(a):b.every(o)?z(a):b.every(p)?A(a):void 0},c.detect=function(b){var f=b.text(),g=e(b);if("no-highlight"==g)return"Unknown Language";var h=g?a.highlight(g,f,!0):a.highlightAuto(f);if(d(h.language))return h.language;var i="undefined"!=typeof h.second_best;if(i&&d(h.second_best.language))return h.second_best.language;var j=i?[h.language,h.second_best.language]:[h.language,"cs"],k=c.findByHeuristics(f,j);return k&&k.length>0?k[0]:"Unknown Language"},c}(window.hljs,window.jQuery,Heuristics||{}),Vesperize=function(a){"use strict";function b(a,b,c){var d=Matcher.matchClassName(a,e)+".java";return d!==b?(c.classname=d,d):b}function c(b){b.fit();var c=b,d=Utils.debounce(function(){c.fit()},250,!1);a(window).on("resize",d),b.stopwatch=new Stopwatch}function d(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}}var e="Scratched",f={silent:!0,width:"inherit",height:"inherit",hideable:!1,intervalinmillis:5e3,actions:[{name:"summary",title:"Summarize code example",icon:"octicon octicon-fold",callback:function(){}}],modes:[],social:[]},g=function(b,c){this.id=Utils.brand("violette"),this.namespace="violette-scratchspace",this.options=a.extend(!0,{},f,c),this.element=a(b),this.handler=[],this.callback=[],this.classname=null,this.codemirror=null,this.editor=null,this.textarea=null,this.status=null,this.stopwatch=null,this.content=null,this.multistage={},this.init()};return g.prototype.init=function(){var b=this;if(this.checkStorage(),null==this.editor){var d=Html.buildHtml("div",{id:this.id,"class":"violette-editor file",click:function(){b.focus()}},{});d.append(Html.buildHeader(this));var e=Html.buildHtml("textarea",b.content,{});d.append(Html.buildBody(this,e)),d.append(Html.buildFooter(this)),this.element.replaceWith(d),a.each(["height","width"],function(c,e){"inherit"!=b.options[e]&&(a.isNumeric(b.options[e])?d.css(e,b.options[e]+"px"):d.addClass(b.options[e]))}),this.editor=d,this.codemirror=Editor.fromTextArea(this.textarea[0],{lineNumbers:!0,styleActiveLine:!0,styleSelectedText:!0,theme:"default",mode:"text/x-java",viewportMargin:1/0,foldGutter:!0,matchBrackets:!0,extraKeys:{"Ctrl-Q":function(a){a.foldCode(a.getCursor())},"Ctrl-S":function(a){b.persist(a.getValue())}},undoDepth:1,gutters:["breakpoints","Editor-linenumbers","Editor-foldgutter"]});var f=13.45,g=a(this.textarea).val().split(/\r\n|\r|\n/).length,h=25>=g?g*f:(g+10)*f;this.codemirror.setSize("100%",h),this.codemirror.refresh(),this.editor.idleTimer(b.options.intervalinmillis),this.bindElements()}else this.editor.show();return c(this),this},g.prototype.bindElements=function(){this.editor.on("click",'[data-provider="violette-scratchspace"]',a.proxy(this.handleClickEvent,this)),this.codemirror.on("focus",a.proxy(this.focus,this)),this.codemirror.on("blur",a.proxy(this.blur,this));var c=this,d=Utils.debounce(function(){var a=c.codemirror.getValue();c.classname=b(a,c.classname,c)},250,!1);this.editor.on("idle.idleTimer",d);var e=Utils.debounce(function(){screenfull.isFullscreen?(c.exchange("fullscreen","octicon-screen-normal"),c.change("fullscreen",function(b){a(b).tooltipster("content","Exit fullscreen")})):(c.exchange("fullscreen","octicon-screen-full"),c.change("fullscreen",function(b){a(b).tooltipster("content","Enter fullscreen")}))},250,!1);this.editor.on(screenfull.raw.fullscreenchange,e)},g.prototype.checkStorage=function(){d()&&localStorage.content&&(this.content=localStorage.content)},g.prototype.handleClickEvent=function(b){var c=this,d=a(b.currentTarget),e=c.handler,f=c.callback,g=d.attr("data-handler"),h=e.indexOf(g),i=f[h];i(c),b.preventDefault()},g.prototype.persist=function(a){return d()?(localStorage.content=a,this.content=null,this):this},g.prototype.change=function(b,c){var d=this,e=d.handler,f="all"==b;a.each(e,function(a,e){var g=f?!1:e.indexOf(b)<0;!g&&c&&c(d.editor.find('button[data-handler="'+e+'"]'))})},g.prototype.exchange=function(a,b){function c(a){var c=a.find("span.mega-octicon");c.length>=1&&(c.hasClass("octicon-screen-full")?(c.removeClass("octicon-screen-full"),c.addClass(b)):c.hasClass("octicon-screen-normal")&&(c.removeClass("octicon-screen-normal"),c.addClass(b)))}var d=this;d.change(a,c)},g.prototype.focus=function(){var b=this.editor;return b.addClass("active"),a(document).find(".violette-editor").each(function(){if(a(this).attr("id")!=b.attr("id")){var c=a(this).find("textarea").data("scratchspace");null==c&&(c=a(this).find('div[data-provider="violette-preview"]').data("scratchspace")),c&&c.blur()}}),this},g.prototype.blur=function(){var a=this.options,b=this.editor,c=a.hideable;return(b.hasClass("active")||0==this.element.parent().length)&&(b.removeClass("active"),c&&b.hide()),this},g.prototype.fit=function(){this.codemirror.refresh()},g}(window.jQuery);!function(a){"use strict";function b(a){a.attr("data-provide","violette-editable"),a.attr("data-savable","true")}function c(a,b){return new Vesperize(a,b)}function d(a){if(0!==a.find("pre").length)return!1;if(a.outerWidth()<100)return!1;var b=a.text().split("\n"),c=b.length;if(15>c)return!1;var d=["java","c","cpp","cs"],e=Heuristics.detect(a);return d.indexOf(e)>-1}function e(b,c){b.mouseenter(function(){var b=a(this).position(),d=a(this).outerWidth();c.css({position:"absolute",top:b.top+5+"px",left:b.left+d-45+"px"}).show(),c.show()}),b.mouseleave(function(){c.hide()}),c.mouseenter(function(b){a(this).show(),b.stopPropagation()}).mouseleave(function(){a(this).hide()})}function f(a){a.attr("title","Edit code"),a.tooltipster({position:"left",theme:"tooltip-custom-theme"})}function g(b){b.unbind("click").click(function(b){var c=a(this).attr("data-scratcher-id"),d=a("pre[data-scratcher-id='"+c+"']");j(d),b.preventDefault()})}var h=0,i=a.fn.scratchspace;a.fn.scratchspace=function(b){return this.each(function(){var d=a(this),e=d.attr("data-scratcher-id"),f=a("div[data-scratcher-id='"+e+"']");f.hide();var g=d.data("scratchspace"),h="object"==typeof b&&b;g||d.data("scratchspace",g=c(this,h))})},a.fn.scratchspace.noConflict=function(){return a.fn.scratchspace=i,this};var j=function(a){return a.data("scratchspace")?void a.data("scratchspace").init():void a.scratchspace(a.data())};a(document).on("click.scratchspace.data-api",'[data-provide="violette-editable"]',function(b){j(a(this)),b.preventDefault()}).ready(function(){a("pre").each(function(){var c=a(this);c.each(function(){var c=a(this);if(d(c)){var i=c.attr("data-provide"),j="undefined"!=typeof i&&i!==!1;if(!j){var k=a("<div/>",{"class":"scratch-button"}),l=a('<button class="violette-button octicon-danger minibutton"><span class="octicon octicon-git-branch"></span></button>');k.append(l),k.attr("data-scratcher-id",h),c.attr("data-scratcher-id",h),b(c),h++,a("body").append(k),k.hide(),e(c,k),f(k),g(k)}}})})})}(window.jQuery);